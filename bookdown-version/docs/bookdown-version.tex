\documentclass[]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={DASD Coding Standards},
            pdfauthor={Data Science Hub},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{natbib}
\bibliographystyle{apalike}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{DASD Coding Standards}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Data Science Hub}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
    \date{}
    \predate{}\postdate{}
  
\usepackage{booktabs}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{reviewer-notes}{%
\chapter{Reviewer notes}\label{reviewer-notes}}

This document is an early attempt at restructuring the current coding standards. At present, every part of the existing coding standards has been incorporated into this document. This is unlikely to be the case for the final product, but I didn't want to lose any essential information early on.

The minimum coding standards have been incorporated into the document \protect\hyperlink{mcstable}{here}. The formatting and sizing of the embedded html file isn't ideal at present, but provides an illustration of what could be done. Do we even still need the minimum coding standards? Can we easily put all the requirements in one place rather than splitting into two?

In addition, further information will be added at later stages - particularly in the form of links to external sites that will support the beginner in understanding some of the concepts.

This document hasn't been spellchecked or rigorously tested yet (e.g.~that links work etc.). This will be done at a later stage when structure has been agreed.

I've also added a section with the recommended \protect\hyperlink{wf}{workflow}. I wonder if this would ideally be brought up to the front of the beginning of the document to illustrate to beginners how each of the sections of the principles fits into their project work?

\hypertarget{intro}{%
\chapter{Introduction}\label{intro}}

This document contains the Data and Analytical Service Directorate's (DASD) coding standards.

\hypertarget{motivation}{%
\section{Motivation}\label{motivation}}

\textbf{Filler Text}\\
Within DASD we use coding standards to ensure that all the code we produce is:

\begin{itemize}
\tightlist
\item
  Reproducible
\item
  Collaborative
\item
  Accurate
\item
  Understandble
\end{itemize}

Why do we want these things? And how will adopting these coding standards enable us to acheive these characteristics for our coding?

\hypertarget{structure}{%
\section{Guidance structure}\label{structure}}

The coding standards are split into two sections:

\begin{itemize}
\tightlist
\item
  Prescriptive minimum coding standards for analytical projects, and
\item
  A set of principles for working on code projects in DASD
\end{itemize}

The minimum coding standards are required for all projects.
The principles have been developed as examples of best practice.

\hypertarget{contributing}{%
\section{Contributing}\label{contributing}}

If you think that something is missing or not quite right you should either:
1. \protect\hyperlink{versioncontrol}{Contribute directly}
2. \href{https://github.com/moj-analytical-services/our-coding-standards/issues}{Raise an issue}

\hypertarget{mcs}{%
\chapter{Minimum Coding Standards}\label{mcs}}

\hypertarget{mcschecklist}{%
\section{Minimum Standards Checklist}\label{mcschecklist}}

All projects should meet our proportionate minimum coding standards, which can be found \href{https://moj-analytical-services.github.io/our-coding-standards/web/}{here}.

This checklist covers:

\begin{itemize}
\tightlist
\item
  Code structure\\
\item
  Reproducibility\\
\item
  Development workflow\\
\item
  Documentation\\
\item
  Unit testing\\
\item
  Dependency management\\
\item
  Packages and versions
\end{itemize}

\hypertarget{mcstable}{%
\section{Minimum Standards Table}\label{mcstable}}

\href{https://moj-analytical-services.github.io/our-coding-standards/web/}{\includegraphics[width=1\linewidth]{bookdown-version_files/figure-latex/url-1} }

\hypertarget{principles}{%
\chapter{Coding Principles}\label{principles}}

The following coding principles have been developed to help achieve the following objectives. (I) Ensure we write high quality, maintainable, code; (II) Where possible, ensure our work is reusable; and (III) Collaborate with one another effectively accross multiple projects.

Code should be:

\textbf{1. \protect\hyperlink{reproduce}{Reproducible}}

\begin{itemize}
\tightlist
\item
  Manage \protect\hyperlink{projdep}{project dependencies}
\item
  Optimise for \protect\hyperlink{change}{change}\\
\item
  Analyses should be \protect\hyperlink{githash}{simple and easy to reproduce} on another machine.
\end{itemize}

\textbf{2. \protect\hyperlink{collaborate}{Collaborative}}

\begin{itemize}
\tightlist
\item
  Use the \protect\hyperlink{versioncontrol}{github workflow} across all projects\\
\item
  \protect\hyperlink{knowledge}{Share} the knowledge
\end{itemize}

\textbf{3. \protect\hyperlink{accurate}{Accurate}}

\begin{itemize}
\tightlist
\item
  Ensure code is \protect\hyperlink{review}{reviewed}
\item
  Complete \protect\hyperlink{unittest}{unit testing}
\end{itemize}

\textbf{4. \protect\hyperlink{understand}{Understandable}}

\begin{itemize}
\tightlist
\item
  Write a \protect\hyperlink{readme}{README} for your project\\
\item
  Use \protect\hyperlink{defaults}{sensible defaults} unless you have a great reason not to
\item
  Write \protect\hyperlink{functions}{functions} where needed\\
\item
  \protect\hyperlink{style}{Stylistic}:

  \begin{itemize}
  \tightlist
  \item
    Apply a \protect\hyperlink{linter}{linter}
  \item
    Ensure \protect\hyperlink{names}{variable names} are meaningful
  \item
    Code should be \protect\hyperlink{ccc}{correct, clear and concise}
  \item
    \protect\hyperlink{errors}{Handle errors}\\
  \item
    Other team members \protect\hyperlink{users}{are users too} - treat them with respect
  \end{itemize}
\end{itemize}

These ideas are stated in no particular order, and are \emph{always} open to debate. In fact, you are encouraged to contribute.

All development is a trade-off between competing pressures, these principles are meant to help you decide which trade-offs are acceptable.

They are guidance, not The Law - there will always be edge cases, but you should expect to be challenged if you go your own way.

\hypertarget{reproduce}{%
\section{Reproducibile}\label{reproduce}}

\hypertarget{projdep}{%
\subsection{Manage project dependencies}\label{projdep}}

\hypertarget{change}{%
\subsection{Optimize for change}\label{change}}

\begin{itemize}
\tightlist
\item
  Don't try to solve every conceivable problem up-front, instead focus on making your code easy to change when needed.
\item
  Don't prematurely optimize - choose clarity over performance, unless there is a serious performance issue that needs to be addressed.
\item
  Change can come in several forms, including hardware - your code will eventually be run on a colleague's machine or a server somewhere. Without overcomplicating things, write your code with this in mind. For example, use relative paths (e.g.~\texttt{./file\_in\_the\_project\_directory.R} rather than \texttt{/Users/my\_username/development/my\_project/file\_in\_the\_project\_directory.R})
\end{itemize}

\hypertarget{githash}{%
\subsection{Reproducing on another machine}\label{githash}}

\hypertarget{include-a-git-hash}{%
\subsubsection*{Include a git hash}\label{include-a-git-hash}}
\addcontentsline{toc}{subsubsection}{Include a git hash}

Some tips on making your analyses simple to reproduce

If practical, the output of your code should include the git hash
of the code that produced it. By doing so, the analysis should be
more reproducible, there is no ambiguity about the specific code
that was used to generate it.

\hypertarget{r}{%
\paragraph{R}\label{r}}
\addcontentsline{toc}{paragraph}{R}

You can access the git hash using either of the following code:
snippets.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(git2r)}

\NormalTok{repo <-}\StringTok{ }\KeywordTok{repository}\NormalTok{(}\StringTok{"."}\NormalTok{)}
\KeywordTok{print}\NormalTok{(}\KeywordTok{head}\NormalTok{(repo))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: 'head.git_repository' is deprecated.
## Use 'repository_head' instead.
## See help("Deprecated")
\end{verbatim}

\begin{verbatim}
## [13c221] (Local) (HEAD) nikki-restructure
\end{verbatim}

or

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\KeywordTok{system}\NormalTok{(}\StringTok{"git rev-parse --short HEAD"}\NormalTok{, }\DataTypeTok{intern =} \OtherTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "13c221e"
\end{verbatim}

\hypertarget{python}{%
\paragraph{Python}\label{python}}
\addcontentsline{toc}{paragraph}{Python}

You can access the git hash using the following code:
```import subprocess

def get\_git\_revision\_hash():
return subprocess.check\_output({[}`git', `rev-parse', `HEAD'{]})

def get\_git\_revision\_short\_hash():
return subprocess.check\_output({[}`git', `rev-parse', `--short', `HEAD'{]})```

\hypertarget{collaborate}{%
\section{Collaborative}\label{collaborate}}

\hypertarget{versioncontrol}{%
\subsection{Version Control}\label{versioncontrol}}

\hypertarget{github-flow-is-a-working-practice-that-helps-to}{%
\subsubsection*{Github-Flow is a working practice that helps to:}\label{github-flow-is-a-working-practice-that-helps-to}}
\addcontentsline{toc}{subsubsection}{Github-Flow is a working practice that helps to:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Facilitate collaboration on a single project
\item
  Protect the codebase
\end{enumerate}

We have tweaked it a little from what is \href{https://guides.github.com/introduction/flow/}{described on GitHub}

\hypertarget{there-are-6-steps-to-our-process}{%
\subsubsection*{There are 6 steps to our process:}\label{there-are-6-steps-to-our-process}}
\addcontentsline{toc}{subsubsection}{There are 6 steps to our process:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Create or clone a repo.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# For example, to clone this repo.}
\FunctionTok{git}\NormalTok{ clone git@github.com:moj-analytical-services/our-coding-standards.git}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  Create an issue in Github that describes what you're working on
  To create an issue, use \href{https://guides.github.com/features/issues/}{the Github website}.
\item
  Create a new branch for the work you're about to do, with a name corresponding to the issue
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# To create a new branch and switch onto it.}
\FunctionTok{git}\NormalTok{ checkout -b my-new-sensibly-named-branch}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  Make some commits on the new branch.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Make some changes then stage each file you've changed - e.g. file1.txt and file2.txt.}
\FunctionTok{git}\NormalTok{ add file1.txt}
\FunctionTok{git}\NormalTok{ add file2.txt}
\CommentTok{# etc}

\CommentTok{# Commit your changes using a descriptive commit message.}
\FunctionTok{git}\NormalTok{ commit}

\CommentTok{# This will take you into your default text editor}
\CommentTok{# Write a descriptive commit message}
\end{Highlighting}
\end{Shaded}

\begin{quote}
\textbf{Note:}
If you have not configured your text editor, you may get stuck in Vim. You can exit using the following command: \texttt{:q!}. Then configure your default text editor for Git
\end{quote}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{git}\NormalTok{ config --global core.editor }\OperatorTok{<}\NormalTok{my-favourite-text-editor}\OperatorTok{>}
 \CommentTok{# Then try again}
\FunctionTok{git}\NormalTok{ commit}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  When you're ready, submit a pull request and wait for peer-review.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# push your branch to the remote repo}
\FunctionTok{git}\NormalTok{ push origin my-new-sensibly-named-branch}
\CommentTok{# then go to github, open a PR and invite at least one reviewer}
\end{Highlighting}
\end{Shaded}

Make sure that you reference the issue in your pull request, by using the hash (\#) symbol - see \href{https://help.github.com/articles/autolinked-references-and-urls/}{here} for further guidance. This makes it easy in future to see what changes were made to the code in response to the issue.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{5}
\item
  To make further changes, just make more commits on the same branch and push them to the remote repo again.
\item
  Once peer review is complete, and any comments addressed, merge into the master branch using a \href{https://github.com/blog/2243-rebase-and-merge-pull-requests}{rebase}.
\item
  The version of master on Github is now ahead of the version of master on your local machine. Bring your local version up to date using \texttt{git\ checkout\ master}, \texttt{git\ pull}. You are now in sync with Github, and ready to start a new branch.
\end{enumerate}

The \textbf{master branch should be 100\% functional at all times}, on any machine. Please ensure it is \href{https://help.github.com/articles/about-protected-branches/}{protected} and that your tests and / or linters run automatically on all pull requests.

For some further reading we strongly suggest reading this \href{https://gist.github.com/blackfalcon/8428401}{article} that explains these git commands and others in a bit more detail.

If you want to test this out, clone this repo and make a contribution :)

\hypertarget{knowledge}{%
\subsection{Share the knowledge}\label{knowledge}}

If you have knowledge which is unique to you, it is your responsibility to share it.
We follow ``github flow'', to keep branches small and short-lived, and ensure knowledge is shared.
You could also present your work at Display DaSH.
If you produce something reusable, package it \& share it with others.
All non-throwaway code should be reviewed - no-one is 100\% right, 100\% of the time.
Be aware that `throwaway' code has a nasty habit of somehow ending up in completed products.

\hypertarget{accurate}{%
\section{Accurate}\label{accurate}}

\hypertarget{review}{%
\subsection{Review}\label{review}}

Ensure that code is reviewed: initiate this through a pull request. Remember that it's always easier (for both you and your reviewers) if you commit and push your changes regularly.

\hypertarget{performing-good-peer-review}{%
\subsubsection*{Performing good peer review}\label{performing-good-peer-review}}
\addcontentsline{toc}{subsubsection}{Performing good peer review}

When you review someone's pull request you become the gatekeeper to the master branch - this is a \emph{very} important job! If you're tasked with this and you're wondering how to proceed asking yourself these questions is a good place to start\ldots{}

1: Do I understand what the code is doing? \protect\hyperlink{users}{Did it need to be explained} to me? \protect\hyperlink{ccc}{Could it be simpler}?

2: Are they using \protect\hyperlink{defaults}{packages / libraries sensibly}?

3: Does it need to be \protect\hyperlink{ccc}{tested} (and is it tested with sufficient coverage)?

4: \protect\hyperlink{ccc}{Does it work}? Does it work on my machine?

5: Are there edge cases that might \protect\hyperlink{errors}{break The Thing}?

If you're reviewing the code of a more experienced coder, this is \textbf{a chance to learn} and you have \emph{every} right to ask for an explanation if there's something that is unclear. It's in everyone's interest that you understand what you're reading and it could well be that you don't yet understand it because the author has made a mistake or overcomplicated something. So \emph{don't hold back}.

If you're on the receiving end of feedback, from anyone at all, this is\ldots{} \textbf{a chance to learn!} :)

\hypertarget{unittest}{%
\subsection{Unit testing}\label{unittest}}

Use testthat and shinytest for unit testing.
LINKS.

\hypertarget{understand}{%
\section{Understandable}\label{understand}}

\hypertarget{readme}{%
\subsection{Include a README}\label{readme}}

By writing a README for your project you're helping others (and your future self) to be able to understand and run your project. Find our template README \href{https://github.com/moj-analytical-services/our-coding-standards/blob/master/README_template.md}{here}.

\hypertarget{defaults}{%
\subsection{Use sensible defaults}\label{defaults}}

There are often many ways of tackling a given problem. As a team, it makes sense to standardise our approach, not because one approach is necessarily better than all others, but because collaboration is easier if there is less diversity in our approaches.

This section sets out sensible defaults which you are expected to follow. They are not strict rules, but you will be expected to explain the benefits of alternative approaches if you want to do something different.

\hypertarget{general}{%
\subsubsection*{General}\label{general}}
\addcontentsline{toc}{subsubsection}{General}

\begin{itemize}
\tightlist
\item
  You should target \href{http://vita.had.co.nz/papers/tidy-data.html}{tidy} data structures as part of your work. You should attempt to convert incoming data into tidy format as quickly as possible, and any data that is output that may be used in other projects should be in tidy format.
\item
  If there is a standardised directory structure for your type of project, using it will help people find things. {[}TODO: Add examples{]}
\end{itemize}

\hypertarget{r-1}{%
\subsubsection*{R}\label{r-1}}
\addcontentsline{toc}{subsubsection}{R}

\begin{itemize}
\tightlist
\item
  Default to packages from the \href{http://tidyverse.org/}{Tidyverse}, because they have been carefully designed to work together effectively as part of a modern data analysis workflow. More info can be found here: \href{http://r4ds.had.co.nz}{R for Data Science by Hadley Wickham}. For example:

  \begin{itemize}
  \tightlist
  \item
    Prefer tibbles to data.frames
  \item
    Use ggplot2 rather than base graphics
  \item
    Use the pipe \texttt{\%\textgreater{}\%} appropriately, but not always e.g.~see \href{https://twitter.com/hadleywickham/status/603883121197514752}{here}.\\
  \item
    Prefer \texttt{purrr} to the \texttt{apply} family of functions. See \href{http://r4ds.had.co.nz/iteration.html\#the-map-functions}{here}
  \end{itemize}
\item
  Use \href{https://rstudio.github.io/packrat/}{Packrat} for R dependencies - it's required by the Analytical Platform if you need to deploy your work.
\item
  R Packages are the \href{http://r-pkgs.had.co.nz/}{fundamental unit of reproducable R code.}
\end{itemize}

\hypertarget{python-1}{%
\subsubsection*{Python}\label{python-1}}
\addcontentsline{toc}{subsubsection}{Python}

\begin{itemize}
\tightlist
\item
  Use Python 3
\item
  Use pandas for data analysis
\item
  Use \texttt{loc} and \texttt{iloc} to write to data frames
\item
  Use Altair for basic data visualisation
\item
  Use Scikit Learn for machine learning
\item
  Use SQLAlchemy and pandas for database interactions, rather than writing your own SQL
\end{itemize}

\hypertarget{encoding-and-csvs}{%
\subsubsection*{Encoding and CSVs}\label{encoding-and-csvs}}
\addcontentsline{toc}{subsubsection}{Encoding and CSVs}

Use unicode. This means you should convert inputs that include non-ASCII characters to unicode as early as possible in your data processing workflow. If you are outputting to text files, these should be encoded in utf-8. Your output csvs should pass \href{https://csvlint.io/}{this} csv linter.

\hypertarget{sql}{%
\subsubsection*{SQL}\label{sql}}
\addcontentsline{toc}{subsubsection}{SQL}

\begin{itemize}
\tightlist
\item
  Use Postgres or SQLite where possible, rather than other SQL database backends.
\end{itemize}

\hypertarget{gis}{%
\subsubsection*{GIS}\label{gis}}
\addcontentsline{toc}{subsubsection}{GIS}

\begin{itemize}
\tightlist
\item
  Use PostGIS as your GIS backend
\item
  Prefer conducting your GIS analysis in code, e.g.~using SQL, rather than point and click in a GUI
\item
  Use QGIS if you need a GUI.
\end{itemize}

\hypertarget{javascript}{%
\subsubsection*{Javascript}\label{javascript}}
\addcontentsline{toc}{subsubsection}{Javascript}

\begin{itemize}
\tightlist
\item
  Use Vega or Vega-lite for pre-constructed charting
\item
  Use d3.js for custom charting
\item
  Use leaflet.js for mapping.
\item
  Use Bootstrap as a style template
\item
  Use underscore.js for data manipulation
\end{itemize}

\hypertarget{finally}{%
\subsubsection*{Finally}\label{finally}}
\addcontentsline{toc}{subsubsection}{Finally}

\begin{itemize}
\tightlist
\item
  If you think of something else we should be doing or using by default, please clone the repo and submit a pull request featuring that addition :)
\end{itemize}

\hypertarget{functions}{%
\subsection{Separate functions out}\label{functions}}

\hypertarget{style}{%
\subsection{Coding style}\label{style}}

\hypertarget{linter}{%
\subsubsection{Apply a linter}\label{linter}}

\hypertarget{names}{%
\subsubsection{Names have power and purpose - use them wisely}\label{names}}

\begin{itemize}
\tightlist
\item
  Don't be cute or jokey when naming things.
\item
  Names convey meaning - well-named functions \& variables can remove the need for a comment and make life a little easier for other readers, including your future self!
\item
  Avoid meaningless names like `obj' / `result' / `foo'.
\item
  Use single-letter variables only where the letter represents a well-known mathematical property (e.g.~e = mc\^{}2), or where their meaning is otherwise clear
\end{itemize}

\hypertarget{ccc}{%
\subsubsection{Code should be correct, clear, concise - in that order}\label{ccc}}

\begin{itemize}
\tightlist
\item
  Correct means demonstrably correct - with tests (ideally) and / or documented \href{quality_assurance.md}{Quality Assurance}. Automated tests are ideal because they allow the code to be refactored with confidence.
\item
  All fixes \& new features should include tests to prevent regressions (i.e.~reappearance of the bug you just fixed).
\item
  Choose clarity over cleverness - use advanced language tricks with care.
\item
  Code should be \href{https://en.wikipedia.org/wiki/Don\%27t_repeat_yourself}{DRY} - which stands for `Don't Repeat Yourself'. - The \href{https://en.wikipedia.org/wiki/Rule_of_three_(computer_programming)}{`Rule of Three'} is a good approach to managing duplication. Less code is usually better - but not at the expense of clarity.\\
\item
  To help with clarity and establish patterns within the team, please use either the \href{https://pypi.python.org/pypi/pep8}{PEP8} style guide (for Python) or \href{https://github.com/jimhester/lintr}{LintR} (for R). The relavant linters will help you with this.
\item
  Ensure that your tests and linters run automatically on all pull requests, if that is possible, by setting up \href{https://travis-ci.org/}{TravisCI} on your repo. This will probably be more complicated than it is worth if your repo is private due to restrictions that are applied to the free TravisCI accounts.
\item
  Use code comments judiciously:
\end{itemize}

\begin{quote}
Good code is its own best documentation. As you're about to add a comment, ask yourself, ``How can I improve the code so that this comment isn't needed?'' Improve the code and then document it to make it even clearer.'' - Steve McConnell
\end{quote}

\hypertarget{errors}{%
\subsubsection{Everything fails at some point}\label{errors}}

Accept this and code defensively when calling other services.
Every HTTP call could error or hang - handle failures appropriately and fail fast. Don't let long-running external calls impact your user experience.
Aim to provide useful information to end users and people working on the code, when something fails.

\hypertarget{users}{%
\subsubsection{Other team members are users too - treat them with respect}\label{users}}

If you have to explain how your code works, then your code is not clear enough.
Be nice to your future self (and assume that they will have forgotten the exact thought process that led to that bit of code you just wrote).
Comments are for explaining why something is needed, not how it works.
Make your commit messages as \href{https://robots.thoughtbot.com/5-useful-tips-for-a-better-commit-message}{informative as possible}

\hypertarget{wf}{%
\chapter{Workflow}\label{wf}}

The recommended workflow for coding projects in DASD is:

Create/clone \protect\hyperlink{versioncontrol}{github repo}\\
Create \protect\hyperlink{versioncontrol}{issue}\\
Create \protect\hyperlink{versioncontrol}{branch}\\
Set up \protect\hyperlink{projdep}{dependency management}\\
Build in \protect\hyperlink{unittest}{unit testing}\\
Commit \protect\hyperlink{versioncontrol}{changes}\\
\protect\hyperlink{review}{Pull request/QA}


\end{document}
